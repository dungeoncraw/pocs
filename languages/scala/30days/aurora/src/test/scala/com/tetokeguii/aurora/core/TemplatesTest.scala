package com.tetokeguii.aurora.core

import munit.FunSuite

class TemplatesTest extends FunSuite:
  test("Templates.layout should render base HTML structure") {
    import scalatags.Text.all.*
    val rendered = Templates.layout("Test Title", "My Site")(div("Hello Content"))
    assert(rendered.contains("<!DOCTYPE html>"))
    assert(rendered.contains("<title>Test Title | My Site</title>"))
    assert(rendered.contains("<h1>My Site</h1>"))
    assert(rendered.contains("Hello Content"))
    assert(rendered.contains("Generated by Aurora Press"))
  }

  test("Templates.post should render a blog post") {
    val fm = FrontMatter("Post Title", "2023-10-10", List("scala", "test"))
    val content = "<p>Post content</p>"
    val rendered = Templates.post(fm, content, "My Site")
    
    assert(rendered.contains("<h2>Post Title</h2>"))
    assert(rendered.contains("Published on 2023-10-10"))
    assert(rendered.contains("Tags: scala, test"))
    assert(rendered.contains("<p>Post content</p>"))
  }

  test("Templates.index should render the home page with post list") {
    val posts = List(
      (FrontMatter("Post 1", "2023-01-01"), "post-1"),
      (FrontMatter("Post 2", "2023-01-02"), "post-2")
    )
    val rendered = Templates.index(posts, "My Site", "Site Description")
    
    assert(rendered.contains("<h2>Site Description</h2>"))
    assert(rendered.contains("href=\"/posts/post-1.html\""))
    assert(rendered.contains("Post 1"))
    assert(rendered.contains("href=\"/posts/post-2.html\""))
    assert(rendered.contains("Post 2"))
  }
